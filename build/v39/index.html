<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="./favicon.png?v=5">
  <title>PMDF/BOPE - Fichas Criminais</title>
  <meta name="description" content="Fichas Criminais PMDF/BOPE - BrasÃ­lia RP" />
  <meta name="author" content="PMDF/BOPE" />

  <meta property="og:title" content="PMDF/BOPE - Fichas Criminais" />
  <meta property="og:description" content="Fichas Criminais PMDF/BOPE - BrasÃ­lia RP" />
  <meta property="og:type" content="website" />

  <script type="module" crossorigin src="/assets/index-Z5Ev_Ti-.js"></script>
  <link rel="stylesheet" crossorigin href="/assets/index-DmCZH8oS.css">
</head>

<body>
  <h2>ğŸ“‹ Registros PMDF - BOPE BRP1</h2>
  <div id="root"></div>

  <script type="module">
    import { createClient } from 'https://esm.sh/@supabase/supabase-js@2';

    // ğŸ”§ Coloque aqui os dados do seu projeto Supabase
const supabaseUrl = 'https://mmfjhxxbjxrpgtxflti.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1tZmpoeHhiamd4cnBndHhmbHRpIiwicm9sIjoiYW5vbiIsImV4cCI6MzEyMzgyOTIsImV4cCI6MjA0MDI5Mn0.gImiWxX6VyLxvA9Ex0vXtoD6348gIZM5LKiO3OAovI';
const supabase = createClient(supabaseUrl, supabaseKey);


    // ğŸ§© FunÃ§Ã£o pra carregar registros iniciais
    async function carregarRegistros() {
      const { data, error } = await supabase
        .from('registros') // nome da tabela
        .select('*')
        .order('id', { ascending: false });

      if (error) {
        console.error('Erro ao carregar registros:', error);
        return;
      }

      mostrarRegistros(data);
    }

    // ğŸ§± FunÃ§Ã£o pra exibir os registros no HTML
    function mostrarRegistros(lista) {
      const container = document.getElementById('root');
      container.innerHTML = '';
      lista.forEach((item) => {
        const div = document.createElement('div');
        div.classList.add('registro');
        div.innerHTML = `
          <strong>${item.nome}</strong> â€” ${item.motivo} <br>
          ğŸ“ ${item.local} <br>
          <small>${new Date(item.created_at).toLocaleString()}</small>
          <hr>
        `;
        container.appendChild(div);
      });
    }

    // ğŸ”„ Escutar novos registros em tempo real
    supabase
      .channel('registros-changes')
      .on(
        'postgres_changes',
        { event: 'INSERT', schema: 'public', table: 'registros' },
        (payload) => {
          console.log('Novo registro:', payload.new);
          adicionarRegistro(payload.new);
        }
      )
      .subscribe();

    // â• Adicionar novo registro visualmente
    function adicionarRegistro(item) {
      const container = document.getElementById('root');
      const div = document.createElement('div');
      div.classList.add('registro');
      div.innerHTML = `
        <strong>${item.nome}</strong> â€” ${item.motivo} <br>
        ğŸ“ ${item.local} <br>
        <small>${new Date(item.created_at).toLocaleString()}</small>
        <hr>
      `;
      container.prepend(div);
    }

    // ğŸš€ Carregar registros ao abrir o site
    carregarRegistros();
  </script>
</body>


</html>